syntax = 'proto3';

package flakka.alpha.build.test.v1alpha1;

message Module {
  string name = 1;
  repeated Aggregate aggregate = 10;
}

message Aggregate {
  string name = 1;
  string package = 2;
  repeated Entity entity = 10;
}

message Entity {
  string name = 1;
  Mutation mutation = 2;
  Projection projection = 3;
}

// Mutation

message Mutation {
  repeated DispatchCommand dispatch_command = 10;
  State state = 2;
}

message DispatchCommand {
  string name = 1;
  Command command = 2;
  Error error = 3;
}

message Command {}

message Error {
  string label = 1;
}

message State {
  repeated StateVariant variant = 1;
}

message StateVariant {
  string name = 1;
}

// Projection

message Projection {
  repeated ViewQuery view_query = 1;
  ViewState view_state = 2;
}

message ViewQuery {
  string name = 1;
  Query query = 2;
  ViewResult result = 3;
}

message Query {}

message ViewResult {}

message ViewState {}

// Event

message Event {
  repeated EventVariant variant = 1;
}

message EventVariant {
  string name = 1;
}
